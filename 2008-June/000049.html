<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Tslib-general] touch screen with x-server
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/tslib-general/2008-June/index.html" >
   <LINK REL="made" HREF="mailto:tslib-general%40lists.berlios.de?Subject=Re%3A%20%5BTslib-general%5D%20touch%20screen%20with%20x-server&In-Reply-To=%3C004d01c8c656%244215ef40%24c641cdc0%24%40com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000048.html">
   <LINK REL="Next"  HREF="000050.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Tslib-general] touch screen with x-server</H1>
    <B>Rakesh Jagota</B> 
    <A HREF="mailto:tslib-general%40lists.berlios.de?Subject=Re%3A%20%5BTslib-general%5D%20touch%20screen%20with%20x-server&In-Reply-To=%3C004d01c8c656%244215ef40%24c641cdc0%24%40com%3E"
       TITLE="[Tslib-general] touch screen with x-server">jrakesh at gdatech.com
       </A><BR>
    <I>Wed Jun  4 17:18:30 CEST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000048.html">[Tslib-general] touch screen with x-server
</A></li>
        <LI>Next message: <A HREF="000050.html">[Tslib-general] touch screen with x-server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#49">[ date ]</a>
              <a href="thread.html#49">[ thread ]</a>
              <a href="subject.html#49">[ subject ]</a>
              <a href="author.html#49">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

This is my strace output along with all the configuration file:

------------------------------------------------------------------------
gda211:~# strace ts_calibrate
execve(&quot;/usr/bin/ts_calibrate&quot;, [&quot;ts_calibrate&quot;], [/* 21 vars */]) = 0
brk(0)                                  = 0x1001f000
access(&quot;/etc/ld.so.nohwcap&quot;, F_OK)      = -1 ENOENT (No such file or directory)
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x3001f000
access(&quot;/etc/ld.so.preload&quot;, R_OK)      = -1 ENOENT (No such file or directory)
open(&quot;/etc/ld.so.cache&quot;, O_RDONLY)      = 3
fstat64(3, {st_mode=S_IFREG|0644, st_size=36358, ...}) = 0
mmap(NULL, 36358, PROT_READ, MAP_PRIVATE, 3, 0) = 0x30020000
close(3)                                = 0
access(&quot;/etc/ld.so.nohwcap&quot;, F_OK)      = -1 ENOENT (No such file or directory)
open(&quot;/usr/lib/libts-0.0.so.0&quot;, O_RDONLY) = 3
read(3, &quot;\177ELF\1\2\1\0\0\0\0\0\0\0\0\0\0\3\0\24\0\0\0\1\0\0\35&quot;..., 512) = 512
fstat64(3, {st_mode=S_IFREG|0644, st_size=14004, ...}) = 0
mmap(0xffdc000, 79308, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0xffdc000
mprotect(0xffdf000, 65536, PROT_NONE)   = 0
mmap(0xffef000, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x3000) = 0xffef000
close(3)                                = 0
access(&quot;/etc/ld.so.nohwcap&quot;, F_OK)      = -1 ENOENT (No such file or directory)
open(&quot;/lib/libdl.so.2&quot;, O_RDONLY)       = 3
read(3, &quot;\177ELF\1\2\1\0\0\0\0\0\0\0\0\0\0\3\0\24\0\0\0\1\0\0\v&quot;..., 512) = 512
fstat64(3, {st_mode=S_IFREG|0644, st_size=13900, ...}) = 0
mmap(0xffb8000, 77952, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0xffb8000
mprotect(0xffbb000, 61440, PROT_NONE)   = 0
mmap(0xffca000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x2000) = 0xffca000
close(3)                                = 0
access(&quot;/etc/ld.so.nohwcap&quot;, F_OK)      = -1 ENOENT (No such file or directory)
open(&quot;/lib/libc.so.6&quot;, O_RDONLY)        = 3
read(3, &quot;\177ELF\1\2\1\0\0\0\0\0\0\0\0\0\0\3\0\24\0\0\0\1\0\1\351&quot;..., 512) = 512
fstat64(3, {st_mode=S_IFREG|0755, st_size=1458348, ...}) = 0
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x30029000
mmap(0xfe32000, 1528376, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0xfe32000
mprotect(0xff90000, 65536, PROT_NONE)   = 0
mmap(0xffa0000, 20480, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x15e000) = 0xffa0000
mmap(0xffa5000, 8760, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0xffa5000
close(3)                                = 0
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x3002a000
mprotect(0xffa0000, 4096, PROT_READ)    = 0
mprotect(0xffca000, 4096, PROT_READ)    = 0
munmap(0x30020000, 36358)               = 0
rt_sigaction(SIGSEGV, {0x100028b0, [SEGV], SA_RESTART}, {SIG_DFL}, 8) = 0
rt_sigaction(SIGINT, {0x100028b0, [INT], SA_RESTART}, {SIG_DFL}, 8) = 0
rt_sigaction(SIGTERM, {0x100028b0, [TERM], SA_RESTART}, {SIG_DFL}, 8) = 0
brk(0)                                  = 0x1001f000
brk(0x10040000)                         = 0x10040000
open(&quot;/dev/input/event2&quot;, O_RDONLY)     = 3
open(&quot;/etc/ts.conf&quot;, O_RDONLY)          = 4
fstat64(4, {st_mode=S_IFREG|0644, st_size=173, ...}) = 0
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x30020000
read(4, &quot;# Uncomment if you wish to use t&quot;..., 4096) = 173
open(&quot;/usr/lib/ts/input.so&quot;, O_RDONLY)  = 5
read(5, &quot;\177ELF\1\2\1\0\0\0\0\0\0\0\0\0\0\3\0\24\0\0\0\1\0\0\31&quot;..., 512) = 512
fstat64(5, {st_mode=S_IFREG|0644, st_size=10892, ...}) = 0
mmap(0xfe0f000, 75176, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 5, 0) = 0xfe0f000
mprotect(0xfe12000, 61440, PROT_NONE)   = 0
mmap(0xfe21000, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 5, 0x2000) = 0xfe21000
close(5)                                = 0
open(&quot;/usr/lib/ts/pthres.so&quot;, O_RDONLY) = 5
read(5, &quot;\177ELF\1\2\1\0\0\0\0\0\0\0\0\0\0\3\0\24\0\0\0\1\0\0\30&quot;..., 512) = 512
fstat64(5, {st_mode=S_IFREG|0644, st_size=10212, ...}) = 0
mmap(0xfdec000, 74508, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 5, 0) = 0xfdec000
mprotect(0xfdef000, 61440, PROT_NONE)   = 0
mmap(0xfdfe000, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 5, 0x2000) = 0xfdfe000
close(5)                                = 0
open(&quot;/usr/lib/ts/variance.so&quot;, O_RDONLY) = 5
read(5, &quot;\177ELF\1\2\1\0\0\0\0\0\0\0\0\0\0\3\0\24\0\0\0\1\0\0\30&quot;..., 512) = 512
fstat64(5, {st_mode=S_IFREG|0644, st_size=10520, ...}) = 0
mmap(0xfdc9000, 74804, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 5, 0) = 0xfdc9000
mprotect(0xfdcc000, 61440, PROT_NONE)   = 0
mmap(0xfddb000, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 5, 0x2000) = 0xfddb000
close(5)                                = 0
open(&quot;/usr/lib/ts/dejitter.so&quot;, O_RDONLY) = 5
read(5, &quot;\177ELF\1\2\1\0\0\0\0\0\0\0\0\0\0\3\0\24\0\0\0\1\0\0\30&quot;..., 512) = 512
fstat64(5, {st_mode=S_IFREG|0644, st_size=10400, ...}) = 0
mmap(0xfda6000, 74684, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 5, 0) = 0xfda6000
mprotect(0xfda9000, 61440, PROT_NONE)   = 0
mmap(0xfdb8000, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 5, 0x2000) = 0xfdb8000
close(5)                                = 0
open(&quot;/usr/lib/ts/linear.so&quot;, O_RDONLY) = 5
read(5, &quot;\177ELF\1\2\1\0\0\0\0\0\0\0\0\0\0\3\0\24\0\0\0\1\0\0\31&quot;..., 512) = 512
fstat64(5, {st_mode=S_IFREG|0644, st_size=10348, ...}) = 0
mmap(0xfd83000, 74632, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 5, 0) = 0xfd83000
mprotect(0xfd86000, 61440, PROT_NONE)   = 0
mmap(0xfd95000, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 5, 0x2000) = 0xfd95000
close(5)                                = 0
stat64(&quot;/etc/pointercal&quot;, {st_mode=S_IFREG|015, st_size=53, ...}) = 0
open(&quot;/etc/pointercal&quot;, O_RDONLY)       = 5
read(5, &quot;-1048579 3136552 53079 -1357505 &quot;..., 200) = 53
close(5)                                = 0
read(4, &quot;&quot;, 4096)                       = 0
close(4)                                = 0
munmap(0x30020000, 4096)                = 0
open(&quot;/dev/fb0&quot;, O_RDWR)                = 4
ioctl(4, FBIOGET_FSCREENINFO, 0x10016e90) = 0
ioctl(4, FBIOGET_VSCREENINFO, 0x10016dec) = 0
mmap(NULL, 2457600, PROT_READ|PROT_WRITE, MAP_SHARED, 4, 0) = 0x30031000
fstat64(1, {st_mode=S_IFCHR|0600, st_rdev=makedev(136, 1), ...}) = 0
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x30020000
write(1, &quot;xres = 1024, yres = 600\n&quot;, 24xres = 1024, yres = 600
) = 24
ioctl(3, EVIOCGVERSION, 0x7f873df8)     = 0
ioctl(3, 0x40204520, 0x7f873dfc)        = 4
ioctl(3, 0x40404523, 0x7f873e00)        = 8
write(2, &quot;selected device is not a touchsc&quot;..., 50selected device is not a touchscreen I understand
) = 50

------------------------------------------------------------------------

My ts.conf file is:

--------------------------------------------------------------------------
module_raw input

module pthres pmin=1
module variance delta=30
module dejitter delta=100
module linear
---------------------------------------------------------------------------

My /etc/profile file is:
-------------------------------------------------------------------

.....
.....
......

export TSLIB_TSDEVICE=/dev/input/event2 ts_calibrate
export TSLIB_CALIBFILE=&quot;/etc/pointercal&quot;
export TSLIB_CONFFILE=&quot;/etc/ts.conf&quot;
export TSLIB_PLUGINDIR=&quot;/usr/lib/ts&quot;
export TSLIB_FBDEVICE=/dev/fb0
export TSLIB_CONSOLEDEVICE=none
--------------------------------------------------------------------

And touch screen section is included in xorg.conf file as well:

---------------------------------------------------------------------

Section &quot;InputDevice&quot;
        Identifier      &quot;wm97xx touchscreen&quot;
        Driver          &quot;tslib&quot;
        Option          &quot;Device&quot;        &quot;/dev/input/event2&quot;
        Option          &quot;DeviceName&quot;    &quot;touchscreen&quot;
        Option          &quot;Protocol&quot;      &quot;Auto&quot;
#       Option          &quot;MinX&quot; &quot;50&quot;
#       Option          &quot;MinY&quot; &quot;50&quot;
#       Option          &quot;MaxX&quot; &quot;800&quot;
#       Option          &quot;MaxY&quot; &quot;600&quot;
        Option          &quot;Rotate&quot; &quot;CCW&quot;
        Option          &quot;ReportingMode&quot; &quot;Raw&quot;
        Option          &quot;SendCoreEvents&quot; &quot;On&quot;
#       Option          &quot;SwapX&quot; &quot;true&quot;
EndSection



Section &quot;ServerLayout&quot;
        Identifier      &quot;Default Layout&quot;
        Screen          &quot;Default Screen&quot;
        InputDevice     &quot;Generic Keyboard&quot;
        InputDevice     &quot;Configured Mouse&quot;
        InputDevice     &quot;wm97xx touchscreen&quot; &quot;CorePointer&quot;
        InputDevice     &quot;dummy&quot;
EndSection


-----------------------------------------------------------------------


And my cat /proc/bus/input/devices output as shown below to confirm the touch screen device:
-------------------------------------------------------------------------------
gda211:~# cat /proc/bus/input/devices 
I: Bus=0003 Vendor=046a Product=0001 Version=0100
N: Name=&quot;HID 046a:0001&quot;
P: Phys=usb-fsl-ehci.0-1.1/input0
S: Sysfs=/class/input/input0
U: Uniq=
H: Handlers=kbd event0 evbug 
B: EV=120003
B: KEY=e080ffdf 1cfffff ffffffff fffffffe
B: LED=7

I: Bus=0003 Vendor=413c Product=3200 Version=0110
N: Name=&quot;Dell Dell USB Mouse&quot;
P: Phys=usb-fsl-ehci.0-1.2/input0
S: Sysfs=/class/input/input1
U: Uniq=
H: Handlers=mouse0 event1 evbug 
B: EV=7
B: KEY=70000 0 0 0 0 0 0 0 0
B: REL=103

I: Bus=0000 Vendor=0000 Product=0000 Version=0000
N: Name=&quot;wm97xx touchscreen&quot;
P: Phys=0-0:WM9711,WM9712/input0
S: Sysfs=/class/input/input2
U: Uniq=
H: Handlers=event2 evbug 
B: EV=9
B: ABS=1000003

gda211:~#


------------------------------------------------------------------------------


Can you have any suggestion?

Regards,
Rakesh Jagota

-----Original Message-----
From: Hinko Ko&#269;evar [mailto:<A HREF="https://lists.berlios.de/mailman/listinfo/tslib-general">hinko.kocevar at cetrtapot.si</A>] 
Sent: Wednesday, June 04, 2008 12:42 AM
To: Rakesh Jagota
Cc: <A HREF="https://lists.berlios.de/mailman/listinfo/tslib-general">tslib-general at lists.berlios.de</A>
Subject: Re: [Tslib-general] touch screen with x-server

Rakesh Jagota wrote:
&gt;<i> Hi,
</I>&gt;<i> 
</I>&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i> I am trying to calibrate my touch screen on ppc based reference platform.
</I>&gt;<i> The LCD resolution is 1024x600.
</I>&gt;<i> 
</I>&gt;<i> While running the 'ts_calibarte' utility I am not seeing any cross-hair
</I>&gt;<i> pointer on the LCD panel and the log message for 'ts_calibrate is as below:
</I>&gt;<i> 
</I>&gt;<i> -------------------------------------------------------------
</I>&gt;<i> 
</I>&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i> gda211:~# ts_calibrate 
</I>&gt;<i> 
</I>&gt;<i> xres = 1024, yres = 600
</I>&gt;<i> 
</I>&gt;<i> selected device is not a touchscreen I understand
</I>
Have you ever took a look at the message above?

&gt;<i> 
</I>&gt;<i> Took 13 samples...
</I>&gt;<i> 
</I>&gt;<i> Top left : X = 805502960 Y = 269287424
</I>&gt;<i> 
</I>&gt;<i> Took 13 samples...
</I>&gt;<i> 
</I>&gt;<i> Top right : X = 805502960 Y = 269287424
</I>&gt;<i> 
</I>&gt;<i> Took 13 samples...
</I>&gt;<i> 
</I>&gt;<i> Bot right : X = 805502960 Y = 269287424
</I>&gt;<i> 
</I>&gt;<i> Took 13 samples...
</I>&gt;<i> 
</I>&gt;<i> Bot left : X = 805502960 Y = 269287424
</I>&gt;<i> 
</I>&gt;<i> Took 13 samples...
</I>&gt;<i> 
</I>&gt;<i> Center : X = 805502960 Y = 269287424
</I>
Looking at these samples they all seem to come from the single touch point - but 
it is almost impossible to touch the panel on the same spot 5 times and the even 
take the same number of samples.. My guess is there is something wrong with
a) your input/touchscreen kernel driver
b) hardware
c) touchscreen connections

I've seen broken touchscreen parts where the panel would return invalid sample 
values when calibrated.
Also the samples shown above are greatly over the max of your touchscreen value 
limits - X 350 - 3900; Y 320 - 3750!?

&gt;<i> 
</I>&gt;<i> export TSLIB_CONSOLEDEVICE=none
</I>
Set this to /dev/tty or /dev/vc/.


HTH,
Hinko

-- 
&#268;ETRTA POT, d.o.o., Kranj
Planina 3
4000 Kranj
Slovenia, Europe
Tel. +386 (0) 4 280 66 03
E-mail: <A HREF="https://lists.berlios.de/mailman/listinfo/tslib-general">hinko.kocevar at cetrtapot.si</A>
Http: www.cetrtapot.si

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000048.html">[Tslib-general] touch screen with x-server
</A></li>
	<LI>Next message: <A HREF="000050.html">[Tslib-general] touch screen with x-server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#49">[ date ]</a>
              <a href="thread.html#49">[ thread ]</a>
              <a href="subject.html#49">[ subject ]</a>
              <a href="author.html#49">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/tslib-general">More information about the Tslib-general
mailing list</a><br>
</body></html>
